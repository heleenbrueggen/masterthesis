summarise(across(bias, ~ mean(.x)), .groups = "drop") %>%
arrange((ngroup*groupsize)) %>%
mutate(dataset = factor(dataset, levels = unique(dataset)),
name = paste0(ngroup*groupsize, '(', ngroup, ',', groupsize, ')', sep = ''))
View(bias_models)
# coverage
#########
# Plots #
#########
# bias for all models and all combinations
bias_models <- tibble(stan4bart = stan4bart_bias$avgbias,
rbart = rbart_bias$avgbias,
bart = bart_bias$avgbias,
gbart = gbart_bias$avgbias,
dataset = paste((combinations[,1]*combinations[,2]), combinations[,1], combinations[,2], combinations[,5], sep = '_')) %>%
cbind(., combinations) %>%
select(-mar_mcar) %>%
pivot_longer(cols = c(stan4bart, rbart, bart, gbart), names_to = 'model', values_to = 'bias') %>%
group_by(dataset, model, icc, ngroup, groupsize, g) %>%
summarise(across(bias, ~ mean(.x)), .groups = "drop") %>%
arrange((ngroup*groupsize)) %>%
mutate(dataset = factor(dataset, levels = unique(dataset)),
name = paste0(ngroup*groupsize, '(', ngroup, ',', groupsize, ')', sep = ' '))
View(bias_models)
# mse for all models and all combinations
mse_models <- tibble(stan4bart = stan4bart_mse$avgmse,
rbart = rbart_mse$avgmse,
bart = bart_mse$avgmse,
gbart = gbart_mse$avgmse,
dataset = paste(combinations[,1], combinations[,2], combinations[,5], sep = '_')) %>%
cbind(., combinations) %>%
select(-mar_mcar) %>%
pivot_longer(cols = c(stan4bart, rbart, bart, gbart), names_to = 'model', values_to = 'mse') %>%
group_by(dataset, model, icc, ngroup, groupsize, g) %>%
summarise(across(mse, ~ mean(.x)), .groups = "drop") %>%
arrange((ngroup*groupsize))  %>%
mutate(dataset = factor(dataset, levels = unique(dataset)),
name = paste0(ngroup*groupsize, '(', ngroup, ',', groupsize, ')', sep = ' '))
# coverage
#########
# Plots #
#########
# bias for all models and all combinations
bias_models <- tibble(stan4bart = stan4bart_bias$avgbias,
rbart = rbart_bias$avgbias,
bart = bart_bias$avgbias,
gbart = gbart_bias$avgbias,
dataset = paste((combinations[,1]*combinations[,2]), combinations[,1], combinations[,2], combinations[,5], sep = '_')) %>%
cbind(., combinations) %>%
select(-mar_mcar) %>%
pivot_longer(cols = c(stan4bart, rbart, bart, gbart), names_to = 'model', values_to = 'bias') %>%
group_by(dataset, model, icc, ngroup, groupsize, g) %>%
summarise(across(bias, ~ mean(.x)), .groups = "drop") %>%
arrange((ngroup*groupsize)) %>%
mutate(dataset = factor(dataset, levels = unique(dataset)),
name = paste0(ngroup*groupsize, '(', ngroup, ',', groupsize, ')', sep = ' '))
ggplot(bias_models ,aes(
x = name,
y = bias,
fill = model,
color = model,
shape = model,
group = model
)) +
geom_point(stat = 'identity') +
geom_line(stat = 'identity', linetype = 'dashed', alpha = .3) +
geom_abline(intercept = 0, slope = 0, linetype = 'dashed') +
labs(
x = 'Simulated dataset (total-sample-size_number-of-groups_group-size_within-group-effect-size)',
y = 'Relative bias') +
theme_bw() +
theme(axis.text.x = element_text(size = 8, angle = 90, hjust = 1)) +
scale_fill_manual(values=cbbPalette) +
scale_color_manual(values=cbbPalette) +
facet_grid(rows = vars(icc), cols = vars(g), labeller = 'label_both', scales = 'free_x')
# coverage
#########
# Plots #
#########
# bias for all models and all combinations
bias_models <- tibble(stan4bart = stan4bart_bias$avgbias,
rbart = rbart_bias$avgbias,
bart = bart_bias$avgbias,
gbart = gbart_bias$avgbias,
dataset = paste((combinations[,1]*combinations[,2]), combinations[,1], combinations[,2], combinations[,5], sep = '_')) %>%
cbind(., combinations) %>%
select(-mar_mcar) %>%
pivot_longer(cols = c(stan4bart, rbart, bart, gbart), names_to = 'model', values_to = 'bias') %>%
group_by(dataset, model, icc, ngroup, groupsize, g) %>%
summarise(across(bias, ~ mean(.x)), .groups = "drop") %>%
arrange((ngroup*groupsize)) %>%
mutate(dataset = factor(dataset, levels = unique(dataset)))
# mse for all models and all combinations
mse_models <- tibble(stan4bart = stan4bart_mse$avgmse,
rbart = rbart_mse$avgmse,
bart = bart_mse$avgmse,
gbart = gbart_mse$avgmse,
dataset = paste(combinations[,1], combinations[,2], combinations[,5], sep = '_')) %>%
cbind(., combinations) %>%
select(-mar_mcar) %>%
pivot_longer(cols = c(stan4bart, rbart, bart, gbart), names_to = 'model', values_to = 'mse') %>%
group_by(dataset, model, icc, ngroup, groupsize, g) %>%
summarise(across(mse, ~ mean(.x)), .groups = "drop") %>%
arrange((ngroup*groupsize))  %>%
mutate(dataset = factor(dataset, levels = unique(dataset)))
ggplot(bias_models ,aes(
x = dataset,
y = bias,
fill = model,
color = model,
shape = model,
group = model
)) +
geom_point(stat = 'identity') +
geom_line(stat = 'identity', linetype = 'dashed', alpha = .3) +
geom_abline(intercept = 0, slope = 0, linetype = 'dashed') +
labs(
x = 'Simulated dataset (total-sample-size_number-of-groups_group-size_within-group-effect-size)',
y = 'Relative bias') +
theme_bw() +
theme(axis.text.x = element_text(size = 8, angle = 90, hjust = 1)) +
scale_fill_manual(values=cbbPalette) +
scale_color_manual(values=cbbPalette) +
facet_grid(rows = vars(icc), cols = vars(g), labeller = 'label_both', scales = 'free_x')
# coverage
#########
# Plots #
#########
# bias for all models and all combinations
bias_models <- tibble(stan4bart = stan4bart_bias$avgbias,
rbart = rbart_bias$avgbias,
bart = bart_bias$avgbias,
gbart = gbart_bias$avgbias,
dataset = paste((combinations[,1]*combinations[,2]), combinations[,1], combinations[,2], sep = '_')) %>%
cbind(., combinations) %>%
select(-mar_mcar) %>%
pivot_longer(cols = c(stan4bart, rbart, bart, gbart), names_to = 'model', values_to = 'bias') %>%
group_by(dataset, model, icc, ngroup, groupsize, g) %>%
summarise(across(bias, ~ mean(.x)), .groups = "drop") %>%
arrange((ngroup*groupsize)) %>%
mutate(dataset = factor(dataset, levels = unique(dataset)))
ggplot(bias_models ,aes(
x = dataset,
y = bias,
fill = model,
color = model,
shape = model,
group = model
)) +
geom_point(stat = 'identity') +
geom_line(stat = 'identity', linetype = 'dashed', alpha = .3) +
geom_abline(intercept = 0, slope = 0, linetype = 'dashed') +
labs(
x = 'Simulated dataset (total-sample-size_number-of-groups_group-size_within-group-effect-size)',
y = 'Relative bias') +
theme_bw() +
theme(axis.text.x = element_text(size = 8, angle = 90, hjust = 1)) +
scale_fill_manual(values=cbbPalette) +
scale_color_manual(values=cbbPalette) +
facet_grid(rows = vars(icc), cols = vars(g), labeller = 'label_both', scales = 'free_x')
View(mse_models)
# coverage
#########
# Plots #
#########
# bias for all models and all combinations
bias_models <- tibble(stan4bart = stan4bart_bias$avgbias,
rbart = rbart_bias$avgbias,
bart = bart_bias$avgbias,
gbart = gbart_bias$avgbias,
dataset = paste((combinations[,1]*combinations[,2]), combinations[,1], combinations[,2], sep = '_')) %>%
cbind(., combinations) %>%
select(-mar_mcar) %>%
pivot_longer(cols = c(stan4bart, rbart, bart, gbart), names_to = 'model', values_to = 'bias') %>%
group_by(dataset, model, icc, ngroup, groupsize, g) %>%
summarise(across(bias, ~ mean(.x)), .groups = "drop") %>%
arrange((ngroup*groupsize)) %>%
mutate(dataset = factor(dataset, levels = unique(dataset)))
# mse for all models and all combinations
mse_models <- tibble(stan4bart = stan4bart_mse$avgmse,
rbart = rbart_mse$avgmse,
bart = bart_mse$avgmse,
gbart = gbart_mse$avgmse,
dataset = paste((combinations[,1]*combinations[,2]), combinations[,1], combinations[,2], sep = '_')) %>%
cbind(., combinations) %>%
select(-mar_mcar) %>%
pivot_longer(cols = c(stan4bart, rbart, bart, gbart), names_to = 'model', values_to = 'mse') %>%
group_by(dataset, model, icc, ngroup, groupsize, g) %>%
summarise(across(mse, ~ mean(.x)), .groups = "drop") %>%
arrange((ngroup*groupsize))  %>%
mutate(dataset = factor(dataset, levels = unique(dataset)))
ggplot(bias_models ,aes(
x = dataset,
y = bias,
fill = model,
color = model,
shape = model,
group = model
)) +
geom_point(stat = 'identity') +
geom_line(stat = 'identity', linetype = 'dashed', alpha = .3) +
geom_abline(intercept = 0, slope = 0, linetype = 'dashed') +
labs(
x = 'Simulated dataset (total-sample-size_number-of-groups_group-size_within-group-effect-size)',
y = 'Relative bias') +
theme_bw() +
theme(axis.text.x = element_text(size = 8, angle = 90, hjust = 1)) +
scale_fill_manual(values=cbbPalette) +
scale_color_manual(values=cbbPalette) +
facet_grid(rows = vars(icc), cols = vars(g), labeller = 'label_both', scales = 'free_x')
ggplot(mse_models ,aes(
x = dataset,
y = mse,
fill = model,
color = model,
shape = model,
group = model
)) +
#geom_bar(stat = 'identity', position = 'identity', width = .05) +
geom_point(stat = 'identity') +
geom_line(stat = 'identity', linetype = 'dashed', alpha = .3) +
labs(
x = 'Simulated dataset (total-sample-size_number-of-groups_group-size_within-group-effect-size)',
y = 'MSE') +
theme_bw() +
theme(axis.text.x = element_text(size = 8, angle = 90, hjust = 1)) +
scale_fill_manual(values=cbbPalette) +
scale_color_manual(values=cbbPalette) +
facet_grid(rows = vars(icc), cols = vars(g), labeller = 'label_both', scales = 'free_x')
# coverage
#########
# Plots #
#########
# bias for all models and all combinations
bias_models <- tibble(stan4bart = stan4bart_bias$avgbias,
rbart = rbart_bias$avgbias,
bart = bart_bias$avgbias,
gbart = gbart_bias$avgbias,
dataset = paste0((combinations[,1]*combinations[,2]), '(', combinations[,1], ',', combinations[,2], ')', sep = '')) %>%
cbind(., combinations) %>%
select(-mar_mcar) %>%
pivot_longer(cols = c(stan4bart, rbart, bart, gbart), names_to = 'model', values_to = 'bias') %>%
group_by(dataset, model, icc, ngroup, groupsize, g) %>%
summarise(across(bias, ~ mean(.x)), .groups = "drop") %>%
arrange((ngroup*groupsize)) %>%
mutate(dataset = factor(dataset, levels = unique(dataset)))
ggplot(bias_models ,aes(
x = dataset,
y = bias,
fill = model,
color = model,
shape = model,
group = model
)) +
geom_point(stat = 'identity') +
geom_line(stat = 'identity', linetype = 'dashed', alpha = .3) +
geom_abline(intercept = 0, slope = 0, linetype = 'dashed') +
labs(
x = 'Simulated dataset (total-sample-size_number-of-groups_group-size_within-group-effect-size)',
y = 'Relative bias') +
theme_bw() +
theme(axis.text.x = element_text(size = 8, angle = 90, hjust = 1)) +
scale_fill_manual(values=cbbPalette) +
scale_color_manual(values=cbbPalette) +
facet_grid(rows = vars(icc), cols = vars(g), labeller = 'label_both', scales = 'free_x')
# coverage
#########
# Plots #
#########
# bias for all models and all combinations
bias_models <- tibble(stan4bart = stan4bart_bias$avgbias,
rbart = rbart_bias$avgbias,
bart = bart_bias$avgbias,
gbart = gbart_bias$avgbias,
dataset = paste0((combinations[,1]*combinations[,2]), '(', combinations[,1], ',', combinations[,2], ')', sep = '')) %>%
cbind(., combinations) %>%
select(-mar_mcar) %>%
pivot_longer(cols = c(stan4bart, rbart, bart, gbart), names_to = 'model', values_to = 'bias') %>%
group_by(dataset, model, icc, ngroup, groupsize, g) %>%
summarise(across(bias, ~ mean(.x)), .groups = "drop") %>%
arrange((ngroup*groupsize)) %>%
mutate(dataset = factor(dataset, levels = unique(dataset)))
# mse for all models and all combinations
mse_models <- tibble(stan4bart = stan4bart_mse$avgmse,
rbart = rbart_mse$avgmse,
bart = bart_mse$avgmse,
gbart = gbart_mse$avgmse,
dataset = paste0((combinations[,1]*combinations[,2]), '(', combinations[,1], ',', combinations[,2], ')', sep = '')) %>%
cbind(., combinations) %>%
select(-mar_mcar) %>%
pivot_longer(cols = c(stan4bart, rbart, bart, gbart), names_to = 'model', values_to = 'mse') %>%
group_by(dataset, model, icc, ngroup, groupsize, g) %>%
summarise(across(mse, ~ mean(.x)), .groups = "drop") %>%
arrange((ngroup*groupsize))  %>%
mutate(dataset = factor(dataset, levels = unique(dataset)))
# saving for presentation
save(bias_models, file = 'oralpresentation/results/bias_models.RData')
# saving for presentation
save(mse_models, file = 'oralpresentation/results/mse_models.RData')
ggplot(bias_models ,aes(
x = dataset,
y = bias,
fill = model,
color = model,
shape = model,
group = model
)) +
geom_point(stat = 'identity') +
geom_line(stat = 'identity', linetype = 'dashed', alpha = .3) +
geom_abline(intercept = 0, slope = 0, linetype = 'dashed') +
labs(
x = 'Simulated dataset (total-sample-size_number-of-groups_group-size_within-group-effect-size)',
y = 'Relative bias') +
theme_bw() +
theme(axis.text.x = element_text(size = 8, angle = 90, hjust = 1)) +
scale_fill_manual(values=cbbPalette) +
scale_color_manual(values=cbbPalette) +
facet_grid(rows = vars(icc), cols = vars(g), labeller = 'label_both', scales = 'free_x')
ggplot(mse_models ,aes(
x = dataset,
y = mse,
fill = model,
color = model,
shape = model,
group = model
)) +
#geom_bar(stat = 'identity', position = 'identity', width = .05) +
geom_point(stat = 'identity') +
geom_line(stat = 'identity', linetype = 'dashed', alpha = .3) +
labs(
x = 'Simulated dataset (total-sample-size_number-of-groups_group-size_within-group-effect-size)',
y = 'MSE') +
theme_bw() +
theme(axis.text.x = element_text(size = 8, angle = 90, hjust = 1)) +
scale_fill_manual(values=cbbPalette) +
scale_color_manual(values=cbbPalette) +
facet_grid(rows = vars(icc), cols = vars(g), labeller = 'label_both', scales = 'free_x')
ggplot(bias_models ,aes(
x = dataset,
y = bias,
fill = model,
color = model,
shape = model,
group = model
)) +
geom_point(stat = 'identity') +
geom_line(stat = 'identity', linetype = 'dashed', alpha = .3) +
geom_abline(intercept = 0, slope = 0, linetype = 'dashed') +
labs(
x = 'Simulated dataset (total sample size (number of groups, group size))',
y = 'Relative bias') +
theme_bw() +
theme(axis.text.x = element_text(size = 8, angle = 90, hjust = 1)) +
scale_fill_manual(values=cbbPalette) +
scale_color_manual(values=cbbPalette) +
facet_grid(rows = vars(icc), cols = vars(g), labeller = 'label_both', scales = 'free_x')
ggplot(mse_models ,aes(
x = dataset,
y = mse,
fill = model,
color = model,
shape = model,
group = model
)) +
#geom_bar(stat = 'identity', position = 'identity', width = .05) +
geom_point(stat = 'identity') +
geom_line(stat = 'identity', linetype = 'dashed', alpha = .3) +
labs(
x = 'Simulated dataset (total sample size (number of groups, group size))',
y = 'MSE') +
theme_bw() +
theme(axis.text.x = element_text(size = 8, angle = 90, hjust = 1)) +
scale_fill_manual(values=cbbPalette) +
scale_color_manual(values=cbbPalette) +
facet_grid(rows = vars(icc), cols = vars(g), labeller = 'label_both', scales = 'free_x')
# coverage
#########
# Plots #
#########
# bias for all models and all combinations
bias_models <- tibble(stan4bart = stan4bart_bias$avgbias,
rbart = rbart_bias$avgbias,
bart = bart_bias$avgbias,
gbart = gbart_bias$avgbias,
dataset = paste0((combinations[,1]*combinations[,2]), ' (', combinations[,1], ', ', combinations[,2], ')', sep = '')) %>%
cbind(., combinations) %>%
select(-mar_mcar) %>%
pivot_longer(cols = c(stan4bart, rbart, bart, gbart), names_to = 'model', values_to = 'bias') %>%
group_by(dataset, model, icc, ngroup, groupsize, g) %>%
summarise(across(bias, ~ mean(.x)), .groups = "drop") %>%
arrange((ngroup*groupsize)) %>%
mutate(dataset = factor(dataset, levels = unique(dataset)))
# saving for presentation
save(bias_models, file = 'oralpresentation/results/bias_models.RData')
# mse for all models and all combinations
mse_models <- tibble(stan4bart = stan4bart_mse$avgmse,
rbart = rbart_mse$avgmse,
bart = bart_mse$avgmse,
gbart = gbart_mse$avgmse,
dataset = paste0((combinations[,1]*combinations[,2]), ' (', combinations[,1], ', ', combinations[,2], ')', sep = '')) %>%
cbind(., combinations) %>%
select(-mar_mcar) %>%
pivot_longer(cols = c(stan4bart, rbart, bart, gbart), names_to = 'model', values_to = 'mse') %>%
group_by(dataset, model, icc, ngroup, groupsize, g) %>%
summarise(across(mse, ~ mean(.x)), .groups = "drop") %>%
arrange((ngroup*groupsize))  %>%
mutate(dataset = factor(dataset, levels = unique(dataset)))
# saving for presentation
save(mse_models, file = 'oralpresentation/results/mse_models.RData')
ggplot(bias_models ,aes(
x = dataset,
y = bias,
fill = model,
color = model,
shape = model,
group = model
)) +
geom_point(stat = 'identity') +
geom_line(stat = 'identity', linetype = 'dashed', alpha = .3) +
geom_abline(intercept = 0, slope = 0, linetype = 'dashed') +
labs(
x = 'Simulated dataset (total sample size (number of groups, group size))',
y = 'Relative bias') +
theme_bw() +
theme(axis.text.x = element_text(size = 8, angle = 90, hjust = 1)) +
scale_fill_manual(values=cbbPalette) +
scale_color_manual(values=cbbPalette) +
facet_grid(rows = vars(icc), cols = vars(g), labeller = 'label_both', scales = 'free_x')
ggplot(mse_models ,aes(
x = dataset,
y = mse,
fill = model,
color = model,
shape = model,
group = model
)) +
#geom_bar(stat = 'identity', position = 'identity', width = .05) +
geom_point(stat = 'identity') +
geom_line(stat = 'identity', linetype = 'dashed', alpha = .3) +
labs(
x = 'Simulated dataset (total sample size (number of groups, group size))',
y = 'MSE') +
theme_bw() +
theme(axis.text.x = element_text(size = 8, angle = 90, hjust = 1)) +
scale_fill_manual(values=cbbPalette) +
scale_color_manual(values=cbbPalette) +
facet_grid(rows = vars(icc), cols = vars(g), labeller = 'label_both', scales = 'free_x')
?rbart_vi
?paste0
ggplot(bias_models ,aes(
x = dataset,
y = bias,
fill = model,
color = model,
shape = model,
group = model
)) +
geom_point(stat = 'identity') +
geom_line(stat = 'identity', linetype = 'dashed', alpha = .3) +
geom_abline(intercept = 0, slope = 0, linetype = 'dashed') +
labs(
x = 'Simulated dataset (total sample size (number of groups, group size))',
y = 'Relative bias') +
theme_bw() +
theme(axis.text.x = element_text(size = 8, angle = 90, hjust = 1)) +
scale_fill_manual(values=cbbPalette) +
scale_color_manual(values=cbbPalette) +
facet_grid(rows = vars(icc), cols = vars(g), labeller = 'label_both', scales = 'free_x')
ggplot(bias_models ,aes(
x = dataset,
y = bias,
fill = model,
color = model,
shape = model,
group = model
)) +
geom_point(stat = 'identity') +
geom_line(stat = 'identity', linetype = 'dashed', alpha = .3) +
geom_abline(intercept = 0, slope = 0, linetype = 'dashed') +
labs(
x = 'Simulated dataset (total sample size (number of groups, group size))',
y = 'Relative bias') +
theme_bw() +
theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1)) +
scale_fill_manual(values=cbbPalette) +
scale_color_manual(values=cbbPalette) +
facet_grid(rows = vars(icc), cols = vars(g), labeller = 'label_both', scales = 'free_x')
ggplot(mse_models ,aes(
x = dataset,
y = mse,
fill = model,
color = model,
shape = model,
group = model
)) +
#geom_bar(stat = 'identity', position = 'identity', width = .05) +
geom_point(stat = 'identity') +
geom_line(stat = 'identity', linetype = 'dashed', alpha = .3) +
labs(
x = 'Simulated dataset (total sample size (number of groups, group size))',
y = 'MSE') +
theme_bw() +
theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1)) +
scale_fill_manual(values=cbbPalette) +
scale_color_manual(values=cbbPalette) +
facet_grid(rows = vars(icc), cols = vars(g), labeller = 'label_both', scales = 'free_x')
View(bart_bias)
View(bart_mse)
385+179
242+254+67+89+314
2500-900-900
700/2
